<!DOCTYPE html>
<html>
  <head>
    <script
      src="https://cdn.plot.ly/plotly-2.35.2.min.js"
      charset="utf-8"
    ></script>

    <meta charset="UTF-8" />
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <!-- <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    />
    <meta
      http-equiv="X-Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    /> -->
    <title>WattWise</title>
  </head>
  <body>
    <h1>WattWise Smart Meter</h1>
    <button id="meterReading">Fetch Readings</button>
    <div
      id="meterContainer"
      style="
        display: flex;
        flex-wrap: wrap;
        width: 131rem;
        height: 100%;
        overflow: scroll;
      "
    ></div>
    <script>
      const numDivs = 11;
      const container = document.getElementById("meterContainer");

      for (let i = 0; i <= numDivs; i++) {
        const newGauge = document.createElement("div");
        newGauge.id = `meter-gauge-${i}`;
        container.appendChild(newGauge);

        var data = [
          {
            domain: { x: [0, 1], y: [0, 1] },
            value: 0,
            title: { text: "Live Usage" },
            type: "indicator",
            mode: "gauge+number",
            gauge: {
              axis: { range: [null, 500] },
              steps: [
                { range: [0, 125], color: "lightgreen" },
                { range: [125, 375], color: "yellow" },
                { range: [375, 500], color: "red" },
              ],
              threshold: {
                line: { color: "darkred", width: 4 },
                thickness: 20,
              },
              bar: {
                color: "white",
                line: { color: "gray", width: 4 },
                threshold: {
                  thickness: 100,
                },
              },
            },
          },
        ];

        var layout = {
          width: 600,
          height: 350,
          margin: { t: 0, b: 0 },
          paper_bgcolor: "rgba(255,255,255,1)", 
          plot_bgcolor: "rgba(255,255,255,1)",  
          shapes: [
            {
              type: "rect",
              x0: 0,
              x1: 1,
              y0: 0,
              y1: 1,
              line: {
                color: "black",  
                width: 2,        
              },
            },
          ],
        };

        Plotly.newPlot(newGauge.id, data, layout);
      }
    </script>
  </body>
  <script src="./renderer.js"></script>
</html>
